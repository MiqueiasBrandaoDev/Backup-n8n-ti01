{"updatedAt":"2025-06-14T14:56:30.250Z","createdAt":"2025-06-12T15:41:16.101Z","id":"sA41V30LFW87G3St","name":"Pagina do chat","active":false,"isArchived":true,"nodes":[{"parameters":{"path":"chat","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-280,-60],"id":"1ed51450-5afc-47d0-86b7-a4325640d699","name":"Webhook","webhookId":"b35f66f4-6700-4742-8f66-e72d28ec8df9"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Agente de Conte√∫do</title>\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: #f7f7f8;\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n        }\n        \n        .chat-container {\n            max-width: 768px;\n            margin: 0 auto;\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            background: white;\n            box-shadow: 0 0 20px rgba(0,0,0,0.1);\n        }\n        \n        .chat-header {\n            padding: 20px;\n            border-bottom: 1px solid #e5e5e5;\n            background: #fff;\n        }\n        \n        .chat-messages {\n            flex: 1;\n            overflow-y: auto;\n            padding: 20px;\n            display: flex;\n            flex-direction: column;\n            gap: 16px;\n        }\n        \n        .message {\n            max-width: 80%;\n            padding: 12px 16px;\n            border-radius: 18px;\n            line-height: 1.4;\n            white-space: pre-wrap;\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            background: #007aff;\n            color: white;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            background: #f1f1f1;\n            color: #333;\n        }\n        \n        .message.success {\n            align-self: flex-start;\n            background: #4CAF50;\n            color: white;\n        }\n        \n        .message.error {\n            align-self: flex-start;\n            background: #f44336;\n            color: white;\n        }\n        \n        .chat-input {\n            padding: 20px;\n            border-top: 1px solid #e5e5e5;\n            display: flex;\n            gap: 12px;\n        }\n        \n        .input-field {\n            flex: 1;\n            padding: 12px 16px;\n            border: 1px solid #ddd;\n            border-radius: 24px;\n            outline: none;\n            font-size: 14px;\n        }\n        \n        .send-button {\n            padding: 12px 24px;\n            background: #007aff;\n            color: white;\n            border: none;\n            border-radius: 20px;\n            cursor: pointer;\n            font-weight: 500;\n            transition: background 0.2s;\n        }\n        \n        .send-button:hover {\n            background: #0056cc;\n        }\n        \n        .send-button:disabled {\n            background: #ccc;\n            cursor: not-allowed;\n        }\n        \n        .typing-indicator {\n            display: none;\n            padding: 12px 16px;\n            background: #f1f1f1;\n            border-radius: 18px;\n            max-width: 80px;\n            align-self: flex-start;\n        }\n        \n        .typing-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .dot {\n            width: 8px;\n            height: 8px;\n            background: #999;\n            border-radius: 50%;\n            animation: typing 1.4s infinite;\n        }\n        \n        .dot:nth-child(2) { animation-delay: 0.2s; }\n        .dot:nth-child(3) { animation-delay: 0.4s; }\n        \n        @keyframes typing {\n            0%, 60%, 100% { transform: translateY(0); }\n            30% { transform: translateY(-10px); }\n        }\n        \n        .content-preview {\n            margin-top: 10px;\n            padding: 15px;\n            background: #f8f9fa;\n            border-radius: 10px;\n            border-left: 4px solid #007aff;\n        }\n        \n        .content-title {\n            font-weight: bold;\n            margin-bottom: 10px;\n            color: #007aff;\n        }\n        \n        .topic-item {\n            margin-bottom: 15px;\n            padding: 10px;\n            background: white;\n            border-radius: 8px;\n            border: 1px solid #e5e5e5;\n        }\n        \n        .topic-title {\n            font-weight: bold;\n            margin-bottom: 8px;\n        }\n        \n        .topic-points {\n            margin-left: 15px;\n            margin-bottom: 8px;\n        }\n        \n        .topic-summary {\n            font-style: italic;\n            color: #666;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"chat-container\">\n        <div class=\"chat-header\">\n            <h2>Agente de Cria√ß√£o de Conte√∫do</h2>\n            <p>Especialista em conte√∫do educacional para Instagram</p>\n        </div>\n        \n        <div class=\"chat-messages\" id=\"messages\">\n            <div class=\"message assistant\">\n                Ol√°! Sou seu agente especializado em cria√ß√£o de conte√∫do educacional. Sobre qual tema voc√™ gostaria de criar um post para Instagram?\n            </div>\n        </div>\n        \n        <div class=\"typing-indicator\" id=\"typing\">\n            <div class=\"typing-dots\">\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n            </div>\n        </div>\n        \n        <div class=\"chat-input\">\n            <input type=\"text\" class=\"input-field\" id=\"messageInput\" placeholder=\"Digite o tema do seu conte√∫do...\">\n            <button class=\"send-button\" id=\"sendButton\" onclick=\"sendMessage()\">Enviar</button>\n        </div>\n    </div>\n\n    <script>\n        const WEBHOOK_URL = 'https://primary-production-70c40.up.railway.app/webhook/17014563-1555-45a7-a8dc-1d9bd5ba4bb1';\n        let isProcessing = false;\n        \n        function addMessage(content, type = 'assistant') {\n            const messagesContainer = document.getElementById('messages');\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${type}`;\n            \n            if (typeof content === 'string') {\n                messageDiv.textContent = content;\n            } else {\n                messageDiv.appendChild(content);\n            }\n            \n            messagesContainer.appendChild(messageDiv);\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n        \n        function addContentPreview(jsonData) {\n            const previewDiv = document.createElement('div');\n            previewDiv.className = 'content-preview';\n            \n            const titleDiv = document.createElement('div');\n            titleDiv.className = 'content-title';\n            titleDiv.textContent = `üìã ${jsonData.titulo_geral} (${jsonData.quantidade_topicos} t√≥picos)`;\n            previewDiv.appendChild(titleDiv);\n            \n            jsonData.topicos.forEach(topico => {\n                const topicDiv = document.createElement('div');\n                topicDiv.className = 'topic-item';\n                \n                const topicTitle = document.createElement('div');\n                topicTitle.className = 'topic-title';\n                topicTitle.textContent = `${topico.id}. ${topico.titulo}`;\n                topicDiv.appendChild(topicTitle);\n                \n                const pointsList = document.createElement('div');\n                pointsList.className = 'topic-points';\n                topico.pontos_chave.forEach(ponto => {\n                    const pointDiv = document.createElement('div');\n                    pointDiv.textContent = `‚Ä¢ ${ponto}`;\n                    pointsList.appendChild(pointDiv);\n                });\n                topicDiv.appendChild(pointsList);\n                \n                const summaryDiv = document.createElement('div');\n                summaryDiv.className = 'topic-summary';\n                summaryDiv.textContent = topico.resumo;\n                topicDiv.appendChild(summaryDiv);\n                \n                previewDiv.appendChild(topicDiv);\n            });\n            \n            return previewDiv;\n        }\n        \n        function showTyping() {\n            document.getElementById('typing').style.display = 'block';\n            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;\n        }\n        \n        function hideTyping() {\n            document.getElementById('typing').style.display = 'none';\n        }\n        \n        function setProcessing(processing) {\n            isProcessing = processing;\n            const sendButton = document.getElementById('sendButton');\n            const messageInput = document.getElementById('messageInput');\n            \n            sendButton.disabled = processing;\n            messageInput.disabled = processing;\n            sendButton.textContent = processing ? 'Processando...' : 'Enviar';\n        }\n        \n        async function sendMessage() {\n            const input = document.getElementById('messageInput');\n            const message = input.value.trim();\n            \n            if (!message || isProcessing) return;\n            \n            addMessage(message, 'user');\n            input.value = '';\n            \n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                // Tenta fazer parse do JSON se a resposta contiver JSON\n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        // Mostra mensagem de sucesso\n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        // Mostra preview do conte√∫do\n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        // Mostra mensagem sobre imagens\n                        addMessage('üé® Imagens sendo geradas e otimizadas para Instagram...', 'assistant');\n                        \n                        // Pergunta se quer criar outro conte√∫do\n                        setTimeout(() => {\n                            addMessage('Gostaria de criar outro conte√∫do sobre um tema diferente?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        // Se n√£o tem JSON, mostra a resposta normal\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    // Se n√£o conseguir fazer parse do JSON, mostra a resposta como texto\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        document.getElementById('messageInput').addEventListener('keypress', function(e) {\n            if (e.key === 'Enter' && !isProcessing) {\n                sendMessage();\n            }\n        });\n    </script>\n</body>\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[-40,-60],"id":"98391f5d-7aa7-4582-8904-9daccbf76afb","name":"HTML"},{"parameters":{"respondWith":"text","responseBody":"={{ $json.html }}","options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.2,"position":[200,-60],"id":"b75158cc-fff6-4928-bc94-d73a4ad31fca","name":"Respond to Webhook1"}],"connections":{"Webhook":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"03d76385-6505-4298-b9e2-e13b8a39b497","triggerCount":1,"shared":[{"updatedAt":"2025-06-12T15:41:16.101Z","createdAt":"2025-06-12T15:41:16.101Z","role":"workflow:owner","workflowId":"sA41V30LFW87G3St","projectId":"BlSED80HESP48veq"}],"tags":[]}