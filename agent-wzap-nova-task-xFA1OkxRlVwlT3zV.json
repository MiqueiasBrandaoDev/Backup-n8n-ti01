{"updatedAt":"2025-04-25T17:38:17.922Z","createdAt":"2025-04-15T17:13:00.189Z","id":"xFA1OkxRlVwlT3zV","name":"AGENT-WZAP-NOVA-TASK","active":true,"isArchived":false,"nodes":[{"parameters":{"promptType":"define","text":"={{ $json[\"grupo-id\"] }}","options":{"systemMessage":"=Data Atual: {{ $now }}\n\nVocê é um agente que faz cadastro de tarefas no clickup para a empresa C&D Blindagem Digital. A cada solicitação vc verifica se existe alguma solicitação, se existir vc vai fazer uma tarefa de acordo com a solicitação do usuario. Vc vai precisar pegar o solicitante e tipo de serviço no clickup. Siga os passos abaixo para coletar essas informações.\n\nO usuario vai informar o grupo-id ou numero privado, entao vc vai inserir na consulta mysql que está na tool e fazer a pesquisa.  Depois vc vai processar essas mensagens para identificar se houve solicitação. Primeiro vc verifica se o dado é um grupo, pesquise o dado informado pelo usuario na coluna `id-autor`, pois vai ser uma conversa privada. Vc vai decidir a tool necessaria, de for de grupo acesse em GET Mensagens - Grupo, se for privado acesse em GET Mensagens - privado. Se você identificar que é uma tarefa que ja está em andamento pela equipe, apenas informe que é uma tarefa em andamento, para verificar na lista de tarefas no clickup.\n\nA solicitação pode ser qualquer dúvida, orientação, elaboração de documento, parecer relacionado a juridico ou empresarial ou qualquer outra coisa para a equipe da C&D Blindagem Digital. Consulte #### GET Custons Field #### os tipos de serviços que temos na toolGET Custons Field para identificar os tipos de serviço que podemos atuar antes de dar continuidade, após obternha o tipo de serviço e siga os proximos passos. Caso ja possua resposta da nossa equipe, pode abortar e informar.\n\n#### Obter Solicitante ####\nPara obter o solicitante, compare o nome do autor da mensagem com a lista de solicitantes cadastrados no clickup, tem um custom field chamado cmz_sollicitantes, use ele e coloque o nome e id do solicitante no retorno. É o node/tool GET Custons Field.\n\n#### Obter Tipo de serviço ####\nPara obter o tipo de serviço correto no clickup, compare o tema do assunto com a lista de tipos de serviços ccadastrados no clickup, tem um custom field chamado cmz_tipo_de_seviço(algo assim), use ele e coloque o nome e id do tipo de serviço no retorno. É o node/tool GET Custons Field.\n\nApós todos esses dados, retorne o json estruturado abaixo com as informações. Em description, coloque todas as mensagens capturadas da conversa, e o autor de cada uma.\n\n{\n  \"name\": \"Nome do tipo de serviço\",\n  \"description\": \"Mensagens da solicitação\",\n  \"assignees\": [\"48925905\"],\n  \"tags\": [],\n  \"status\": \"Backlog\",\n  \"priority\": 2,\n  \"due_date\": 1746000000000,\n  \"due_date_time\": false,\n  \"time_estimate\": 7200000,\n  \"start_date\": 1745587200000,\n  \"start_date_time\": false,\n  \"notify_all\": true,\n  \"parent\": null,\n  \"links_to\": null,\n  \"custom_fields\": [\n    {\n      \"id\": \"12c0e6ee-ab61-4789-8646-62dc78b208ec\",\n      \"value\": \"ID do tipo de serviço\"\n    },\n    {\n      \"id\": \"af809f3b-efe7-4e08-a772-a5b641ac7221\",\n      \"value\": \"ID do solicitante\"\n    }\n  ]\n}\n\nSe houver qualquer indicio que é uma solitação que ja está em andamento, RETORNE SOMENTE: NULL. Você só vai atuar para novas tarefas.\nRETORNE SOMENTE O JSON, CASO SEJA NOVA TAREFA. SE NAO FOR RETORNE: NULL"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[-800,-260],"id":"5c8ff32a-9f7c-4425-a22a-2add0a44cc4f","name":"AGENT WZAP NOVA TASK"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-880,-40],"id":"d78b63f7-2368-467e-8de3-d07d226756a1","name":"GPT-4o","credentials":{"openAiApi":{"id":"73zR8e7wjf7OCHDR","name":"Agent-wzap"}}},{"parameters":{"toolDescription":"Aqui vc vai pegar 2 informações,\n\nOs solicitantes\nOs tipos de serviços","url":"https://api.clickup.com/api/v2/space/60963728/field","sendHeaders":true,"parametersHeaders":{"values":[{"name":"Content-Type","valueProvider":"fieldValue","value":"application/json"},{"name":"Authorization","valueProvider":"fieldValue","value":"pk_42999166_MQATMSYXYJW0LE7JK9RYMUQR62180Q16"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[-340,-60],"id":"73ef9b1c-3d24-41f7-bb50-bbf2a1b09b84","name":"GET Custons Field"},{"parameters":{"operation":"executeQuery","query":"SELECT * FROM `msg`\nWHERE `lida` = 0\n  AND `grupo-id` = '{{ $('When Executed by Another Workflow').item.json[\"grupo-id\"] }}';","options":{}},"type":"n8n-nodes-base.mySqlTool","typeVersion":2.4,"position":[-600,140],"id":"b3e310cc-10d8-469c-ae09-7267ddc70027","name":"GET Mensagens - Grupo","credentials":{"mySql":{"id":"qcW74rM8fMjTo8mj","name":"agente-wzap"}}},{"parameters":{"operation":"executeQuery","query":"SELECT * FROM `msg`\nWHERE `lida` = 0\n  AND `id-autor` = '{{ $('When chat message received').item.json.chatInput }}';","options":{}},"type":"n8n-nodes-base.mySqlTool","typeVersion":2.4,"position":[-480,40],"id":"f7ff079f-1173-40b3-88c7-350fa2765262","name":"GET Mensagens - Privado","credentials":{"mySql":{"id":"qcW74rM8fMjTo8mj","name":"agente-wzap"}},"disabled":true},{"parameters":{"workflowInputs":{"values":[{"name":"grupo-id"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-1020,-260],"id":"718467e2-7ab9-4960-9b09-c8b32a9ae60f","name":"When Executed by Another Workflow"},{"parameters":{"assignments":{"assignments":[{"id":"8f477a0b-08ca-460f-a65a-f7704077ce79","name":"return","value":"={{ $json.output }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-440,-260],"id":"6f4f6717-c423-44a3-8d94-642b6d55c1ba","name":"Final result"}],"connections":{"GPT-4o":{"ai_languageModel":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_languageModel","index":0}]]},"GET Custons Field":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"GET Mensagens - Grupo":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"GET Mensagens - Privado":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"AGENT WZAP NOVA TASK","type":"main","index":0}]]},"AGENT WZAP NOVA TASK":{"main":[[{"node":"Final result","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"grupo-id":"120363399432473247@g.us"}}]},"versionId":"c4dc5fb5-56f2-4bdf-b7fe-91b07f0cae87","activeVersionId":"c4dc5fb5-56f2-4bdf-b7fe-91b07f0cae87","triggerCount":0,"shared":[{"updatedAt":"2025-04-15T17:13:00.189Z","createdAt":"2025-04-15T17:13:00.189Z","role":"workflow:owner","workflowId":"xFA1OkxRlVwlT3zV","projectId":"BlSED80HESP48veq"}],"activeVersion":{"updatedAt":"2025-12-01T11:56:54.083Z","createdAt":"2025-12-01T11:56:54.083Z","versionId":"c4dc5fb5-56f2-4bdf-b7fe-91b07f0cae87","workflowId":"xFA1OkxRlVwlT3zV","nodes":[{"parameters":{"promptType":"define","text":"={{ $json[\"grupo-id\"] }}","options":{"systemMessage":"=Data Atual: {{ $now }}\n\nVocê é um agente que faz cadastro de tarefas no clickup para a empresa C&D Blindagem Digital. A cada solicitação vc verifica se existe alguma solicitação, se existir vc vai fazer uma tarefa de acordo com a solicitação do usuario. Vc vai precisar pegar o solicitante e tipo de serviço no clickup. Siga os passos abaixo para coletar essas informações.\n\nO usuario vai informar o grupo-id ou numero privado, entao vc vai inserir na consulta mysql que está na tool e fazer a pesquisa.  Depois vc vai processar essas mensagens para identificar se houve solicitação. Primeiro vc verifica se o dado é um grupo, pesquise o dado informado pelo usuario na coluna `id-autor`, pois vai ser uma conversa privada. Vc vai decidir a tool necessaria, de for de grupo acesse em GET Mensagens - Grupo, se for privado acesse em GET Mensagens - privado. Se você identificar que é uma tarefa que ja está em andamento pela equipe, apenas informe que é uma tarefa em andamento, para verificar na lista de tarefas no clickup.\n\nA solicitação pode ser qualquer dúvida, orientação, elaboração de documento, parecer relacionado a juridico ou empresarial ou qualquer outra coisa para a equipe da C&D Blindagem Digital. Consulte #### GET Custons Field #### os tipos de serviços que temos na toolGET Custons Field para identificar os tipos de serviço que podemos atuar antes de dar continuidade, após obternha o tipo de serviço e siga os proximos passos. Caso ja possua resposta da nossa equipe, pode abortar e informar.\n\n#### Obter Solicitante ####\nPara obter o solicitante, compare o nome do autor da mensagem com a lista de solicitantes cadastrados no clickup, tem um custom field chamado cmz_sollicitantes, use ele e coloque o nome e id do solicitante no retorno. É o node/tool GET Custons Field.\n\n#### Obter Tipo de serviço ####\nPara obter o tipo de serviço correto no clickup, compare o tema do assunto com a lista de tipos de serviços ccadastrados no clickup, tem um custom field chamado cmz_tipo_de_seviço(algo assim), use ele e coloque o nome e id do tipo de serviço no retorno. É o node/tool GET Custons Field.\n\nApós todos esses dados, retorne o json estruturado abaixo com as informações. Em description, coloque todas as mensagens capturadas da conversa, e o autor de cada uma.\n\n{\n  \"name\": \"Nome do tipo de serviço\",\n  \"description\": \"Mensagens da solicitação\",\n  \"assignees\": [\"48925905\"],\n  \"tags\": [],\n  \"status\": \"Backlog\",\n  \"priority\": 2,\n  \"due_date\": 1746000000000,\n  \"due_date_time\": false,\n  \"time_estimate\": 7200000,\n  \"start_date\": 1745587200000,\n  \"start_date_time\": false,\n  \"notify_all\": true,\n  \"parent\": null,\n  \"links_to\": null,\n  \"custom_fields\": [\n    {\n      \"id\": \"12c0e6ee-ab61-4789-8646-62dc78b208ec\",\n      \"value\": \"ID do tipo de serviço\"\n    },\n    {\n      \"id\": \"af809f3b-efe7-4e08-a772-a5b641ac7221\",\n      \"value\": \"ID do solicitante\"\n    }\n  ]\n}\n\nSe houver qualquer indicio que é uma solitação que ja está em andamento, RETORNE SOMENTE: NULL. Você só vai atuar para novas tarefas.\nRETORNE SOMENTE O JSON, CASO SEJA NOVA TAREFA. SE NAO FOR RETORNE: NULL"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":1.8,"position":[-800,-260],"id":"5c8ff32a-9f7c-4425-a22a-2add0a44cc4f","name":"AGENT WZAP NOVA TASK"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[-880,-40],"id":"d78b63f7-2368-467e-8de3-d07d226756a1","name":"GPT-4o","credentials":{"openAiApi":{"id":"73zR8e7wjf7OCHDR","name":"Agent-wzap"}}},{"parameters":{"toolDescription":"Aqui vc vai pegar 2 informações,\n\nOs solicitantes\nOs tipos de serviços","url":"https://api.clickup.com/api/v2/space/60963728/field","sendHeaders":true,"parametersHeaders":{"values":[{"name":"Content-Type","valueProvider":"fieldValue","value":"application/json"},{"name":"Authorization","valueProvider":"fieldValue","value":"pk_42999166_MQATMSYXYJW0LE7JK9RYMUQR62180Q16"}]}},"type":"@n8n/n8n-nodes-langchain.toolHttpRequest","typeVersion":1.1,"position":[-340,-60],"id":"73ef9b1c-3d24-41f7-bb50-bbf2a1b09b84","name":"GET Custons Field"},{"parameters":{"operation":"executeQuery","query":"SELECT * FROM `msg`\nWHERE `lida` = 0\n  AND `grupo-id` = '{{ $('When Executed by Another Workflow').item.json[\"grupo-id\"] }}';","options":{}},"type":"n8n-nodes-base.mySqlTool","typeVersion":2.4,"position":[-600,140],"id":"b3e310cc-10d8-469c-ae09-7267ddc70027","name":"GET Mensagens - Grupo","credentials":{"mySql":{"id":"qcW74rM8fMjTo8mj","name":"agente-wzap"}}},{"parameters":{"operation":"executeQuery","query":"SELECT * FROM `msg`\nWHERE `lida` = 0\n  AND `id-autor` = '{{ $('When chat message received').item.json.chatInput }}';","options":{}},"type":"n8n-nodes-base.mySqlTool","typeVersion":2.4,"position":[-480,40],"id":"f7ff079f-1173-40b3-88c7-350fa2765262","name":"GET Mensagens - Privado","credentials":{"mySql":{"id":"qcW74rM8fMjTo8mj","name":"agente-wzap"}},"disabled":true},{"parameters":{"workflowInputs":{"values":[{"name":"grupo-id"}]}},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-1020,-260],"id":"718467e2-7ab9-4960-9b09-c8b32a9ae60f","name":"When Executed by Another Workflow"},{"parameters":{"assignments":{"assignments":[{"id":"8f477a0b-08ca-460f-a65a-f7704077ce79","name":"return","value":"={{ $json.output }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-440,-260],"id":"6f4f6717-c423-44a3-8d94-642b6d55c1ba","name":"Final result"}],"connections":{"GPT-4o":{"ai_languageModel":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_languageModel","index":0}]]},"GET Custons Field":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"GET Mensagens - Grupo":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"GET Mensagens - Privado":{"ai_tool":[[{"node":"AGENT WZAP NOVA TASK","type":"ai_tool","index":0}]]},"When Executed by Another Workflow":{"main":[[{"node":"AGENT WZAP NOVA TASK","type":"main","index":0}]]},"AGENT WZAP NOVA TASK":{"main":[[{"node":"Final result","type":"main","index":0}]]}},"authors":"system migration","name":null,"description":null,"autosaved":false},"tags":[{"updatedAt":"2025-04-15T17:22:06.213Z","createdAt":"2025-04-15T17:22:06.213Z","id":"dj75wiwsp56Shp4j","name":"WZAP"}]}