{"updatedAt":"2025-07-09T22:42:02.392Z","createdAt":"2025-07-09T22:02:28.468Z","id":"Ge9iRKX6IE09MeGs","name":"HISTORICO MSG EVOLUTION","active":false,"isArchived":false,"nodes":[{"parameters":{"resource":"chat-api","operation":"find-messages","instanceName":"Miqueias","remoteJid":"556281294749","offset":3000},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[-320,-40],"id":"12bc084a-518d-4ca8-a243-d753daa06517","name":"Procurar mensagens de um contato","credentials":{"evolutionApi":{"id":"V2fpHnZeAReBnCaU","name":"Evolution account"}}},{"parameters":{"fieldToSplitOut":"data.messages.records","options":{}},"type":"n8n-nodes-base.splitOut","typeVersion":1,"position":[-100,-40],"id":"b7374f27-f054-4e0a-8153-44b977582980","name":"Split Out"},{"parameters":{"fieldsToAggregate":{"fieldToAggregate":[{"fieldToAggregate":"message.conversation"},{"fieldToAggregate":"pushName"}]},"options":{}},"type":"n8n-nodes-base.aggregate","typeVersion":1,"position":[100,-40],"id":"dc053d3d-4465-43e6-a78b-e6197272768b","name":"Aggregate"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.chatTrigger","typeVersion":1.1,"position":[-560,-40],"id":"bfe007ff-3812-46e0-b76b-8d161724f7f4","name":"When chat message received","webhookId":"7b6a0231-8657-4e66-a43f-867d2eea615a"},{"parameters":{"promptType":"define","text":"={{ $('When chat message received').item.json.chatInput }}","options":{"systemMessage":"=Vc é o Miqueias na conversa e Ana vai perguntar as coisas. Responda na mesma linguagem que Miqueias costuma falar, use a linguagem natural do Miqueias. Ana é namorada de Miqueias. Não precisa ser tão fofo\n\nSegue mensagems:\n{{ $json.values() }}"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2,"position":[360,-40],"id":"3a83255f-4f36-44be-86b7-26189850fe79","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"chatgpt-4o-latest","mode":"list","cachedResultName":"chatgpt-4o-latest"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[320,180],"id":"77573e9f-4ce9-41e3-a119-a9cae5170e85","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"bEHAhmQV1LUjIUXy","name":"OpenAi account"}}},{"parameters":{"sessionIdType":"customKey","sessionKey":"={{ $('When chat message received').item.json.sessionId }}"},"type":"@n8n/n8n-nodes-langchain.memoryRedisChat","typeVersion":1.5,"position":[440,180],"id":"7d62e674-ab34-4adb-beed-ed5670f3a2be","name":"Redis Chat Memory","credentials":{"redis":{"id":"1f7hNvPJVM2bjGpi","name":"Redis account"}}}],"connections":{"Procurar mensagens de um contato":{"main":[[{"node":"Split Out","type":"main","index":0}]]},"Split Out":{"main":[[{"node":"Aggregate","type":"main","index":0}]]},"Aggregate":{"main":[[{"node":"AI Agent","type":"main","index":0}]]},"When chat message received":{"main":[[{"node":"Procurar mensagens de um contato","type":"main","index":0}]]},"AI Agent":{"main":[[]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Redis Chat Memory":{"ai_memory":[[{"node":"AI Agent","type":"ai_memory","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"1b0148f5-55f9-4524-83f2-782105826472","activeVersionId":null,"triggerCount":0,"shared":[{"updatedAt":"2025-07-09T22:02:28.468Z","createdAt":"2025-07-09T22:02:28.468Z","role":"workflow:owner","workflowId":"Ge9iRKX6IE09MeGs","projectId":"BlSED80HESP48veq"}],"activeVersion":null,"tags":[]}