{"updatedAt":"2025-06-20T15:50:15.583Z","createdAt":"2025-06-16T14:06:15.880Z","id":"Ycc5y7W1I81nYpDZ","name":"Pagina do Chat","active":true,"isArchived":false,"nodes":[{"parameters":{"path":"rag2","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-60,0],"id":"9a426465-c4c3-499a-ad16-2516688c9627","name":"Webhook","webhookId":"1e7b87aa-4017-4252-b38a-dd5de5ae1bed"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Agente de Conte√∫do</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n            color: #e4e4e7;\n        }\n        \n        .chat-container {\n            max-width: 800px;\n            margin: 20px auto;\n            min-height: calc(100vh - 40px);\n            display: flex;\n            flex-direction: column;\n            background: #222222;\n            border-radius: 12px;\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);\n            overflow: visible;\n        }\n        \n        .chat-header {\n            padding: 24px;\n            border-bottom: 1px solid #3a3a3a;\n            background: #2a2a2a;\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            border-radius: 12px 12px 0 0;\n        }\n        \n        .header-content {\n            flex: 1;\n        }\n        \n        .chat-header h2 {\n            font-size: 1.5rem;\n            font-weight: 600;\n            color: #ffffff;\n            margin-bottom: 4px;\n        }\n        \n        .chat-header p {\n            font-size: 0.9rem;\n            color: #a1a1aa;\n        }\n        \n        /* Bot√£o de Treinamento */\n        .training-button {\n            padding: 8px 16px;\n            background: #3b82f6;\n            color: #ffffff;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.8rem;\n            transition: all 0.2s ease;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            white-space: nowrap;\n            margin-left: 16px;\n            flex-shrink: 0;\n        }\n        \n        .training-button:hover {\n            background: #2563eb;\n        }\n        \n        /* Estilos do Formul√°rio */\n        .form-container {\n            flex: 1;\n            padding: 32px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            gap: 24px;\n            min-height: 400px;\n        }\n        \n        .form-title {\n            text-align: center;\n            font-size: 1.2rem;\n            font-weight: 600;\n            color: #ffffff;\n            margin-bottom: 8px;\n        }\n        \n        .form-subtitle {\n            text-align: center;\n            color: #a1a1aa;\n            margin-bottom: 24px;\n        }\n        \n        .form-field {\n            display: flex;\n            flex-direction: column;\n            gap: 8px;\n        }\n        \n        .form-label {\n            font-weight: 500;\n            color: #e4e4e7;\n            font-size: 0.95rem;\n        }\n        \n        .form-input {\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n            font-family: 'Inter', sans-serif;\n        }\n        \n        .form-input:focus {\n            border-color: #22c55e;\n        }\n        \n        .form-input::placeholder {\n            color: #6b7280;\n        }\n        \n        .form-select {\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n            font-family: 'Inter', sans-serif;\n            cursor: pointer;\n        }\n        \n        .form-select:focus {\n            border-color: #22c55e;\n        }\n        \n        .form-button {\n            padding: 16px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 600;\n            font-size: 1rem;\n            transition: background 0.2s ease;\n            margin-top: 16px;\n        }\n        \n        .form-button:hover {\n            background: #16a34a;\n        }\n        \n        .form-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .form-help {\n            font-size: 0.85rem;\n            color: #a1a1aa;\n            margin-top: 4px;\n        }\n        \n        /* Bot√£o adicional no formul√°rio */\n        .form-training-button {\n            padding: 12px 20px;\n            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n            color: #ffffff;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.9rem;\n            transition: all 0.2s ease;\n            margin-top: 8px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n        }\n        \n        .form-training-button:hover {\n            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n            transform: translateY(-1px);\n        }\n        \n        /* Estilos do Chat */\n        .chat-messages {\n            flex: 1;\n            overflow-y: auto;\n            overflow-x: hidden;\n            padding: 24px;\n            display: none;\n            flex-direction: column;\n            gap: 16px;\n            min-height: 400px;\n            max-height: calc(100vh - 300px);\n            scrollbar-width: thin;\n            scrollbar-color: #4a4a4a #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar {\n            width: 8px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-track {\n            background: #222222;\n            border-radius: 4px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb {\n            background: #4a4a4a;\n            border-radius: 4px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb:hover {\n            background: #5a5a5a;\n        }\n        \n        .message {\n            max-width: 75%;\n            padding: 12px 16px;\n            border-radius: 12px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            font-size: 0.95rem;\n            transition: all 0.2s ease;\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);\n            color: #ffffff;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            background: #3a3a3a;\n            color: #e4e4e7;\n        }\n        \n        .message.success {\n            align-self: flex-start;\n            background: #22c55e;\n            color: #ffffff;\n        }\n        \n        .message.error {\n            align-self: flex-start;\n            background: #ef4444;\n            color: #ffffff;\n        }\n        \n        .chat-input {\n            padding: 20px;\n            border-top: 1px solid #3a3a3a;\n            display: none;\n            gap: 12px;\n            background: #2a2a2a;\n            border-radius: 0 0 12px 12px;\n            flex-shrink: 0;\n        }\n        \n        .input-field {\n            flex: 1;\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n        }\n        \n        .input-field:focus {\n            border-color: #22c55e;\n        }\n        \n        .send-button {\n            padding: 12px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.95rem;\n            transition: background 0.2s ease;\n        }\n        \n        .send-button:hover {\n            background: #16a34a;\n        }\n        \n        .send-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .typing-indicator {\n            display: none;\n            padding: 12px 16px;\n            background: #3a3a3a;\n            border-radius: 12px;\n            max-width: 80px;\n            align-self: flex-start;\n            margin-bottom: 16px;\n        }\n        \n        .typing-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .dot {\n            width: 8px;\n            height: 8px;\n            background: #a1a1aa;\n            border-radius: 50%;\n            animation: typing 1.4s infinite;\n        }\n        \n        .dot:nth-child(2) { animation-delay: 0.2s; }\n        .dot:nth-child(3) { animation-delay: 0.4s; }\n        \n        @keyframes typing {\n            0%, 60%, 100% { transform: translateY(0); }\n            30% { transform: translateY(-10px); }\n        }\n        \n        .content-preview {\n            margin-top: 12px;\n            padding: 16px;\n            background: #2a2a2a;\n            border-radius: 12px;\n            border-left: 4px solid #22c55e;\n            max-width: 100%;\n            overflow: hidden;\n        }\n        \n        .content-title {\n            font-weight: 600;\n            font-size: 1.1rem;\n            margin-bottom: 12px;\n            color: #22c55e;\n        }\n        \n        .topic-item {\n            margin-bottom: 16px;\n            padding: 12px;\n            background: #333333;\n            border-radius: 8px;\n            border: 1px solid #4a4a4a;\n        }\n        \n        .topic-title {\n            font-weight: 600;\n            font-size: 1rem;\n            margin-bottom: 8px;\n            color: #e4e4e7;\n        }\n        \n        .topic-points {\n            margin-left: 16px;\n            margin-bottom: 8px;\n            color: #d4d4d8;\n        }\n        \n        .topic-summary {\n            font-style: italic;\n            color: #a1a1aa;\n            font-size: 0.9rem;\n        }\n\n        /* Responsividade */\n        @media (max-width: 768px) {\n            .chat-container {\n                margin: 10px;\n                max-width: calc(100vw - 20px);\n            }\n            \n            .chat-header {\n                flex-direction: column;\n                gap: 12px;\n                align-items: stretch;\n            }\n            \n            .training-button {\n                margin-left: 0;\n                align-self: flex-end;\n            }\n            \n            .form-container {\n                padding: 20px;\n            }\n            \n            .chat-messages {\n                max-height: calc(100vh - 250px);\n                padding: 16px;\n            }\n        }\n\n        /* Garantir que o container principal tenha scroll quando necess√°rio */\n        .chat-container.chat-active {\n            min-height: calc(100vh - 40px);\n            max-height: none;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"chat-container\" id=\"chatContainer\">\n        <div class=\"chat-header\">\n            <div class=\"header-content\">\n                <h2>Agente de Cria√ß√£o de Conte√∫do</h2>\n                <p>Especialista em conte√∫do para Instagram</p>\n            </div>\n        </div>\n        \n        <!-- Formul√°rio Inicial -->\n        <div class=\"form-container\" id=\"formContainer\">\n            <div class=\"form-title\">Configure seu conte√∫do</div>\n            <div class=\"form-subtitle\">Preencha as informa√ß√µes abaixo para come√ßar</div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"temaGeral\">1. Tema Geral</label>\n                <input type=\"text\" class=\"form-input\" id=\"temaGeral\" placeholder=\"Ex: Marketing Digital, Fitness, Culin√°ria...\">\n            </div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"topicoObrigatorio\">2. T√≥pico Obrigat√≥rio</label>\n                <input type=\"text\" class=\"form-input\" id=\"topicoObrigatorio\" placeholder=\"Digite um t√≥pico espec√≠fico ou deixe vazio\">\n                <div class=\"form-help\">Se n√£o tiver prefer√™ncia, deixe vazio (ser√° enviado como \"NENHUM\")</div>\n            </div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"quantidadeTopicos\">3. Quantidade de T√≥picos</label>\n                <select class=\"form-select\" id=\"quantidadeTopicos\">\n                    <option value=\"\">Selecione a quantidade</option>\n                    <option value=\"3\">3 t√≥picos</option>\n                    <option value=\"5\">5 t√≥picos</option>\n                    <option value=\"7\">7 t√≥picos</option>\n                    <option value=\"10\">10 t√≥picos</option>\n                </select>\n            </div>\n            \n            <button class=\"form-button\" onclick=\"startChat()\">Come√ßar Cria√ß√£o</button>\n            \n            <button class=\"form-training-button\" onclick=\"openTrainingPage()\">\n                üìö Treinar este Agente com um Documento\n            </button>\n        </div>\n        \n        <!-- Chat (oculto inicialmente) -->\n        <div class=\"chat-messages\" id=\"messages\"></div>\n        \n        <div class=\"typing-indicator\" id=\"typing\">\n            <div class=\"typing-dots\">\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n            </div>\n        </div>\n        \n        <div class=\"chat-input\" id=\"chatInput\">\n            <input type=\"text\" class=\"input-field\" id=\"messageInput\" placeholder=\"Digite sua mensagem...\">\n            <button class=\"send-button\" id=\"sendButton\" onclick=\"sendMessage()\">Enviar</button>\n        </div>\n    </div>\n\n    <script>\n        const WEBHOOK_URL = 'https://primary-production-70c40.up.railway.app/webhook/2d666699-53d5-4ceb-ac71-913ee7125e6f';\n        const TRAINING_URL = 'https://primary-production-70c40.up.railway.app/webhook/updatefile-rag';\n        let isProcessing = false;\n        let formData = {};\n        \n        function openTrainingPage() {\n            window.open(TRAINING_URL, '_blank');\n        }\n        \n        function startChat() {\n            const temaGeral = document.getElementById('temaGeral').value.trim();\n            const topicoObrigatorio = document.getElementById('topicoObrigatorio').value.trim();\n            const quantidadeTopicos = document.getElementById('quantidadeTopicos').value;\n            \n            // Valida√ß√£o\n            if (!temaGeral) {\n                alert('Por favor, preencha o tema geral');\n                return;\n            }\n            \n            if (!quantidadeTopicos) {\n                alert('Por favor, selecione a quantidade de t√≥picos');\n                return;\n            }\n            \n            // Armazena os dados do formul√°rio\n            // Se t√≥pico obrigat√≥rio estiver vazio, usa \"NENHUM\"\n            const topicoFinal = topicoObrigatorio || 'NENHUM';\n            \n            formData = {\n                temaGeral,\n                topicoObrigatorio: topicoFinal,\n                quantidadeTopicos\n            };\n            \n            // Adiciona classe para ativar modo chat\n            document.getElementById('chatContainer').classList.add('chat-active');\n            \n            // Oculta o formul√°rio e mostra o chat\n            document.getElementById('formContainer').style.display = 'none';\n            document.getElementById('messages').style.display = 'flex';\n            document.getElementById('chatInput').style.display = 'flex';\n            \n            // Cria mensagem inicial no formato exato exigido (3 linhas)\n            const initialMessage = `${temaGeral}\\n${topicoFinal}\\n${quantidadeTopicos}`;\n            \n            // Adiciona mensagem de boas-vindas\n            addMessage(`Perfeito! Vou criar conte√∫do sobre \"${temaGeral}\" com ${quantidadeTopicos} t√≥picos.`, 'assistant');\n            \n            if (topicoFinal !== 'NENHUM') {\n                addMessage(`T√≥pico obrigat√≥rio inclu√≠do: \"${topicoFinal}\"`, 'assistant');\n            } else {\n                addMessage('Sem t√≥pico obrigat√≥rio espec√≠fico.', 'assistant');\n            }\n            \n            addMessage('Processando sua solicita√ß√£o...', 'assistant');\n            \n            // Envia automaticamente a primeira mensagem\n            sendInitialMessage(initialMessage);\n        }\n        \n        async function sendInitialMessage(message) {\n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Como posso ajudar voc√™ a refinar este conte√∫do?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        function addMessage(content, type = 'assistant') {\n            const messagesContainer = document.getElementById('messages');\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${type}`;\n\n            if (typeof content === 'string') {\n                // Verifica se o conte√∫do cont√©m m√∫ltiplos links\n                const lines = content.trim().split('\\n');\n                const links = lines.filter(line => /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                \n                if (links.length > 0 && type === 'assistant') {\n                    // Se h√° links, cria um container para os bot√µes\n                    const linksContainer = document.createElement('div');\n                    linksContainer.style.display = 'flex';\n                    linksContainer.style.flexDirection = 'column';\n                    linksContainer.style.gap = '8px';\n                    \n                    links.forEach((link, index) => {\n                        const button = document.createElement('button');\n                        button.textContent = `Abrir Link ${index + 1}`;\n                        button.onclick = () => window.open(link.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        button.style.transition = 'background 0.2s ease';\n                        \n                        // Adiciona hover effect\n                        button.addEventListener('mouseenter', () => {\n                            button.style.background = '#16a34a';\n                        });\n                        button.addEventListener('mouseleave', () => {\n                            button.style.background = '#22c55e';\n                        });\n                        \n                        linksContainer.appendChild(button);\n                    });\n                    \n                    // Se h√° texto al√©m dos links, adiciona antes dos bot√µes\n                    const nonLinkLines = lines.filter(line => !/^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                    if (nonLinkLines.length > 0) {\n                        const textDiv = document.createElement('div');\n                        textDiv.textContent = nonLinkLines.join('\\n');\n                        textDiv.style.marginBottom = '12px';\n                        messageDiv.appendChild(textDiv);\n                    }\n                    \n                    messageDiv.appendChild(linksContainer);\n                } else {\n                    // Caso n√£o seja link ou seja um link √∫nico sem quebras de linha\n                    const isLink = /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(content.trim());\n                    if (isLink && type === 'assistant') {\n                        const button = document.createElement('button');\n                        button.textContent = 'Abrir Link';\n                        button.onclick = () => window.open(content.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        messageDiv.appendChild(button);\n                    } else {\n                        messageDiv.textContent = content;\n                    }\n                }\n            } else {\n                messageDiv.appendChild(content);\n            }\n\n            messagesContainer.appendChild(messageDiv);\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n\n        function addContentPreview(jsonData) {\n            const previewDiv = document.createElement('div');\n            previewDiv.className = 'content-preview';\n            \n            const titleDiv = document.createElement('div');\n            titleDiv.className = 'content-title';\n            titleDiv.textContent = `üìã ${jsonData.titulo_geral} (${jsonData.quantidade_topicos} t√≥picos)`;\n            previewDiv.appendChild(titleDiv);\n            \n            jsonData.topicos.forEach(topico => {\n                const topicDiv = document.createElement('div');\n                topicDiv.className = 'topic-item';\n                \n                const topicTitle = document.createElement('div');\n                topicTitle.className = 'topic-title';\n                topicTitle.textContent = `${topico.id}. ${topico.titulo}`;\n                topicDiv.appendChild(topicTitle);\n                \n                const pointsList = document.createElement('div');\n                pointsList.className = 'topic-points';\n                topico.pontos_chave.forEach(ponto => {\n                    const pointDiv = document.createElement('div');\n                    pointDiv.textContent = `‚Ä¢ ${ponto}`;\n                    pointsList.appendChild(pointDiv);\n                });\n                topicDiv.appendChild(pointsList);\n                \n                const summaryDiv = document.createElement('div');\n                summaryDiv.className = 'topic-summary';\n                summaryDiv.textContent = topico.resumo;\n                topicDiv.appendChild(summaryDiv);\n                \n                previewDiv.appendChild(topicDiv);\n            });\n            \n            return previewDiv;\n        }\n        \n        function showTyping() {\n            const messagesContainer = document.getElementById('messages');\n            const typingIndicator = document.getElementById('typing');\n            \n            messagesContainer.appendChild(typingIndicator);\n            typingIndicator.style.display = 'block';\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n        \n        function hideTyping() {\n            const typingIndicator = document.getElementById('typing');\n            typingIndicator.style.display = 'none';\n        }\n        \n        function setProcessing(processing) {\n            isProcessing = processing;\n            const sendButton = document.getElementById('sendButton');\n            const messageInput = document.getElementById('messageInput');\n            \n            sendButton.disabled = processing;\n            messageInput.disabled = processing;\n            sendButton.textContent = processing ? 'Processando...' : 'Enviar';\n        }\n        \n        async function sendMessage() {\n            const input = document.getElementById('messageInput');\n            const message = input.value.trim();\n            \n            if (!message || isProcessing) return;\n            \n            addMessage(message, 'user');\n            input.value = '';\n            \n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas para Instagram...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Como posso ajudar voc√™ a refinar este conte√∫do?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        document.getElementById('messageInput').addEventListener('keypress', function(e) {\n            if (e.key === 'Enter' && !isProcessing) {\n                sendMessage();\n            }\n        });\n    </script>\n</body>\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[180,0],"id":"c1815231-089f-41c4-b770-151d3575eca6","name":"HTML"},{"parameters":{"respondWith":"text","responseBody":"={{ $json.html }}","options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.2,"position":[420,0],"id":"fa29ce02-c2e1-46ee-97b5-5d8deabbedba","name":"Respond to Webhook1"},{"parameters":{"content":"## DOWNLOAD","height":240,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[-260,-60],"typeVersion":1,"id":"245a17f0-7055-4f39-aa99-eba598adc645","name":"Sticky Note"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Agente de Conte√∫do</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            color: #e4e4e7;\n        }\n        \n        .chat-container {\n            max-width: 800px;\n            margin: 20px auto;\n            height: calc(100vh - 40px);\n            display: flex;\n            flex-direction: column;\n            background: #222222;\n            border-radius: 12px;\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);\n            overflow: hidden;\n        }\n        \n        .chat-header {\n            padding: 24px;\n            border-bottom: 1px solid #3a3a3a;\n            background: #2a2a2a;\n        }\n        \n        .chat-header h2 {\n            font-size: 1.5rem;\n            font-weight: 600;\n            color: #ffffff;\n        }\n        \n        .chat-header p {\n            font-size: 0.9rem;\n            color: #a1a1aa;\n            margin-top: 4px;\n        }\n        \n        .chat-messages {\n            flex: 1;\n            overflow-y: auto;\n            padding: 24px;\n            display: flex;\n            flex-direction: column;\n            gap: 16px;\n            scrollbar-width: thin;\n            scrollbar-color: #4a4a4a #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar {\n            width: 6px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-track {\n            background: #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb {\n            background: #4a4a4a;\n            border-radius: 3px;\n        }\n        \n        .message {\n            max-width: 75%;\n            padding: 12px 16px;\n            border-radius: 12px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            font-size: 0.95rem;\n            transition: all 0.2s ease;\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);\n            color: #ffffff;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            background: #3a3a3a;\n            color: #e4e4e7;\n        }\n        \n        .message.success {\n            align-self: flex-start;\n            background: #22c55e;\n            color: #ffffff;\n        }\n        \n        .message.error {\n            align-self: flex-start;\n            background: #ef4444;\n            color: #ffffff;\n        }\n        \n        .chat-input {\n            padding: 20px;\n            border-top: 1px solid #3a3a3a;\n            display: flex;\n            gap: 12px;\n            background: #2a2a2a;\n        }\n        \n        .input-field {\n            flex: 1;\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n        }\n        \n        .input-field:focus {\n            border-color: #22c55e;\n        }\n        \n        .send-button {\n            padding: 12px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.95rem;\n            transition: background 0.2s ease;\n        }\n        \n        .send-button:hover {\n            background: #16a34a;\n        }\n        \n        .send-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .typing-indicator {\n            display: none;\n            padding: 12px 16px;\n            background: #3a3a3a;\n            border-radius: 12px;\n            max-width: 80px;\n            align-self: flex-start;\n        }\n        \n        .typing-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .dot {\n            width: 8px;\n            height: 8px;\n            background: #a1a1aa;\n            border-radius: 50%;\n            animation: typing 1.4s infinite;\n        }\n        \n        .dot:nth-child(2) { animation-delay: 0.2s; }\n        .dot:nth-child(3) { animation-delay: 0.4s; }\n        \n        @keyframes typing {\n            0%, 60%, 100% { transform: translateY(0); }\n            30% { transform: translateY(-10px); }\n        }\n        \n        .content-preview {\n            margin-top: 12px;\n            padding: 16px;\n            background: #2a2a2a;\n            border-radius: 12px;\n            border-left: 4px solid #22c55e;\n        }\n        \n        .content-title {\n            font-weight: 600;\n            font-size: 1.1rem;\n            margin-bottom: 12px;\n            color: #22c55e;\n        }\n        \n        .topic-item {\n            margin-bottom: 16px;\n            padding: 12px;\n            background: #333333;\n            border-radius: 8px;\n            border: 1px solid #4a4a4a;\n        }\n        \n        .topic-title {\n            font-weight: 600;\n            font-size: 1rem;\n            margin-bottom: 8px;\n            color: #e4e4e7;\n        }\n        \n        .topic-points {\n            margin-left: 16px;\n            margin-bottom: 8px;\n            color: #d4d4d8;\n        }\n        \n        .topic-summary {\n            font-style: italic;\n            color: #a1a1aa;\n            font-size: 0.9rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"chat-container\">\n        <div class=\"chat-header\">\n            <h2>Agente de Cria√ß√£o de Conte√∫do</h2>\n            <p>Especialista em conte√∫do para Instagram</p>\n        </div>\n        \n        <div class=\"chat-messages\" id=\"messages\">\n            <div class=\"message assistant\">Ol√°! Sou seu agente especializado em cria√ß√£o de conte√∫do. Sobre qual tema voc√™ gostaria de criar um post para Instagram?</div>\n        </div>\n        \n        <div class=\"typing-indicator\" id=\"typing\">\n            <div class=\"typing-dots\">\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n            </div>\n        </div>\n        \n        <div class=\"chat-input\">\n            <input type=\"text\" class=\"input-field\" id=\"messageInput\" placeholder=\"Digite o tema do seu conte√∫do...\">\n            <button class=\"send-button\" id=\"sendButton\" onclick=\"sendMessage()\">Enviar</button>\n        </div>\n    </div>\n\n    <script>\n        const WEBHOOK_URL = 'https://primary-production-70c40.up.railway.app/webhook/2d666699-53d5-4ceb-ac71-913ee7125e6f';\n        let isProcessing = false;\n        \n        function addMessage(content, type = 'assistant') {\n            const messagesContainer = document.getElementById('messages');\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${type}`;\n\n            if (typeof content === 'string') {\n                // Verifica se o conte√∫do cont√©m m√∫ltiplos links\n                const lines = content.trim().split('\\n');\n                const links = lines.filter(line => /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                \n                if (links.length > 0 && type === 'assistant') {\n                    // Se h√° links, cria um container para os bot√µes\n                    const linksContainer = document.createElement('div');\n                    linksContainer.style.display = 'flex';\n                    linksContainer.style.flexDirection = 'column';\n                    linksContainer.style.gap = '8px';\n                    \n                    links.forEach((link, index) => {\n                        const button = document.createElement('button');\n                        button.textContent = `Abrir Link ${index + 1}`;\n                        button.onclick = () => window.open(link.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        button.style.transition = 'background 0.2s ease';\n                        \n                        // Adiciona hover effect\n                        button.addEventListener('mouseenter', () => {\n                            button.style.background = '#16a34a';\n                        });\n                        button.addEventListener('mouseleave', () => {\n                            button.style.background = '#22c55e';\n                        });\n                        \n                        linksContainer.appendChild(button);\n                    });\n                    \n                    // Se h√° texto al√©m dos links, adiciona antes dos bot√µes\n                    const nonLinkLines = lines.filter(line => !/^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                    if (nonLinkLines.length > 0) {\n                        const textDiv = document.createElement('div');\n                        textDiv.textContent = nonLinkLines.join('\\n');\n                        textDiv.style.marginBottom = '12px';\n                        messageDiv.appendChild(textDiv);\n                    }\n                    \n                    messageDiv.appendChild(linksContainer);\n                } else {\n                    // Caso n√£o seja link ou seja um link √∫nico sem quebras de linha\n                    const isLink = /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(content.trim());\n                    if (isLink && type === 'assistant') {\n                        const button = document.createElement('button');\n                        button.textContent = 'Abrir Link';\n                        button.onclick = () => window.open(content.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        messageDiv.appendChild(button);\n                    } else {\n                        messageDiv.textContent = content;\n                    }\n                }\n            } else {\n                messageDiv.appendChild(content);\n            }\n\n            messagesContainer.appendChild(messageDiv);\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n\n        function addContentPreview(jsonData) {\n            const previewDiv = document.createElement('div');\n            previewDiv.className = 'content-preview';\n            \n            const titleDiv = document.createElement('div');\n            titleDiv.className = 'content-title';\n            titleDiv.textContent = `üìã ${jsonData.titulo_geral} (${jsonData.quantidade_topicos} t√≥picos)`;\n            previewDiv.appendChild(titleDiv);\n            \n            jsonData.topicos.forEach(topico => {\n                const topicDiv = document.createElement('div');\n                topicDiv.className = 'topic-item';\n                \n                const topicTitle = document.createElement('div');\n                topicTitle.className = 'topic-title';\n                topicTitle.textContent = `${topico.id}. ${topico.titulo}`;\n                topicDiv.appendChild(topicTitle);\n                \n                const pointsList = document.createElement('div');\n                pointsList.className = 'topic-points';\n                topico.pontos_chave.forEach(ponto => {\n                    const pointDiv = document.createElement('div');\n                    pointDiv.textContent = `‚Ä¢ ${ponto}`;\n                    pointsList.appendChild(pointDiv);\n                });\n                topicDiv.appendChild(pointsList);\n                \n                const summaryDiv = document.createElement('div');\n                summaryDiv.className = 'topic-summary';\n                summaryDiv.textContent = topico.resumo;\n                topicDiv.appendChild(summaryDiv);\n                \n                previewDiv.appendChild(topicDiv);\n            });\n            \n            return previewDiv;\n        }\n        \n        function showTyping() {\n            document.getElementById('typing').style.display = 'block';\n            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;\n        }\n        \n        function hideTyping() {\n            document.getElementById('typing').style.display = 'none';\n        }\n        \n        function setProcessing(processing) {\n            isProcessing = processing;\n            const sendButton = document.getElementById('sendButton');\n            const messageInput = document.getElementById('messageInput');\n            \n            sendButton.disabled = processing;\n            messageInput.disabled = processing;\n            sendButton.textContent = processing ? 'Processando...' : 'Enviar';\n        }\n        \n        async function sendMessage() {\n            const input = document.getElementById('messageInput');\n            const message = input.value.trim();\n            \n            if (!message || isProcessing) return;\n            \n            addMessage(message, 'user');\n            input.value = '';\n            \n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas para Instagram...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Gostaria de criar outro conte√∫do sobre um tema diferente?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        document.getElementById('messageInput').addEventListener('keypress', function(e) {\n            if (e.key === 'Enter' && !isProcessing) {\n                sendMessage();\n            }\n        });\n    </script>\n</body>\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[180,720],"id":"531eb6ac-63df-46de-83aa-cc80a342c58a","name":"HTML1"},{"parameters":{"content":"## BACKUP","height":240,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[-260,660],"typeVersion":1,"id":"bdd71e07-d424-4810-a7f7-acf709769322","name":"Sticky Note1"}],"connections":{"Webhook":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0}]]},"HTML1":{"main":[[]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"e34421ff-364b-4406-9389-6b4af91b8e4f","activeVersionId":"e34421ff-364b-4406-9389-6b4af91b8e4f","triggerCount":1,"shared":[{"updatedAt":"2025-06-16T14:06:15.880Z","createdAt":"2025-06-16T14:06:15.880Z","role":"workflow:owner","workflowId":"Ycc5y7W1I81nYpDZ","projectId":"BlSED80HESP48veq"}],"activeVersion":{"updatedAt":"2025-12-01T11:56:54.083Z","createdAt":"2025-12-01T11:56:54.083Z","versionId":"e34421ff-364b-4406-9389-6b4af91b8e4f","workflowId":"Ycc5y7W1I81nYpDZ","nodes":[{"parameters":{"path":"rag2","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2,"position":[-60,0],"id":"9a426465-c4c3-499a-ad16-2516688c9627","name":"Webhook","webhookId":"1e7b87aa-4017-4252-b38a-dd5de5ae1bed"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Agente de Conte√∫do</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);\n            min-height: 100vh;\n            display: flex;\n            flex-direction: column;\n            color: #e4e4e7;\n        }\n        \n        .chat-container {\n            max-width: 800px;\n            margin: 20px auto;\n            min-height: calc(100vh - 40px);\n            display: flex;\n            flex-direction: column;\n            background: #222222;\n            border-radius: 12px;\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);\n            overflow: visible;\n        }\n        \n        .chat-header {\n            padding: 24px;\n            border-bottom: 1px solid #3a3a3a;\n            background: #2a2a2a;\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-start;\n            border-radius: 12px 12px 0 0;\n        }\n        \n        .header-content {\n            flex: 1;\n        }\n        \n        .chat-header h2 {\n            font-size: 1.5rem;\n            font-weight: 600;\n            color: #ffffff;\n            margin-bottom: 4px;\n        }\n        \n        .chat-header p {\n            font-size: 0.9rem;\n            color: #a1a1aa;\n        }\n        \n        /* Bot√£o de Treinamento */\n        .training-button {\n            padding: 8px 16px;\n            background: #3b82f6;\n            color: #ffffff;\n            border: none;\n            border-radius: 6px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.8rem;\n            transition: all 0.2s ease;\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            white-space: nowrap;\n            margin-left: 16px;\n            flex-shrink: 0;\n        }\n        \n        .training-button:hover {\n            background: #2563eb;\n        }\n        \n        /* Estilos do Formul√°rio */\n        .form-container {\n            flex: 1;\n            padding: 32px;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            gap: 24px;\n            min-height: 400px;\n        }\n        \n        .form-title {\n            text-align: center;\n            font-size: 1.2rem;\n            font-weight: 600;\n            color: #ffffff;\n            margin-bottom: 8px;\n        }\n        \n        .form-subtitle {\n            text-align: center;\n            color: #a1a1aa;\n            margin-bottom: 24px;\n        }\n        \n        .form-field {\n            display: flex;\n            flex-direction: column;\n            gap: 8px;\n        }\n        \n        .form-label {\n            font-weight: 500;\n            color: #e4e4e7;\n            font-size: 0.95rem;\n        }\n        \n        .form-input {\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n            font-family: 'Inter', sans-serif;\n        }\n        \n        .form-input:focus {\n            border-color: #22c55e;\n        }\n        \n        .form-input::placeholder {\n            color: #6b7280;\n        }\n        \n        .form-select {\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n            font-family: 'Inter', sans-serif;\n            cursor: pointer;\n        }\n        \n        .form-select:focus {\n            border-color: #22c55e;\n        }\n        \n        .form-button {\n            padding: 16px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 600;\n            font-size: 1rem;\n            transition: background 0.2s ease;\n            margin-top: 16px;\n        }\n        \n        .form-button:hover {\n            background: #16a34a;\n        }\n        \n        .form-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .form-help {\n            font-size: 0.85rem;\n            color: #a1a1aa;\n            margin-top: 4px;\n        }\n        \n        /* Bot√£o adicional no formul√°rio */\n        .form-training-button {\n            padding: 12px 20px;\n            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n            color: #ffffff;\n            border: none;\n            border-radius: 8px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.9rem;\n            transition: all 0.2s ease;\n            margin-top: 8px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            gap: 8px;\n        }\n        \n        .form-training-button:hover {\n            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n            transform: translateY(-1px);\n        }\n        \n        /* Estilos do Chat */\n        .chat-messages {\n            flex: 1;\n            overflow-y: auto;\n            overflow-x: hidden;\n            padding: 24px;\n            display: none;\n            flex-direction: column;\n            gap: 16px;\n            min-height: 400px;\n            max-height: calc(100vh - 300px);\n            scrollbar-width: thin;\n            scrollbar-color: #4a4a4a #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar {\n            width: 8px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-track {\n            background: #222222;\n            border-radius: 4px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb {\n            background: #4a4a4a;\n            border-radius: 4px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb:hover {\n            background: #5a5a5a;\n        }\n        \n        .message {\n            max-width: 75%;\n            padding: 12px 16px;\n            border-radius: 12px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            font-size: 0.95rem;\n            transition: all 0.2s ease;\n            word-wrap: break-word;\n            overflow-wrap: break-word;\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);\n            color: #ffffff;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            background: #3a3a3a;\n            color: #e4e4e7;\n        }\n        \n        .message.success {\n            align-self: flex-start;\n            background: #22c55e;\n            color: #ffffff;\n        }\n        \n        .message.error {\n            align-self: flex-start;\n            background: #ef4444;\n            color: #ffffff;\n        }\n        \n        .chat-input {\n            padding: 20px;\n            border-top: 1px solid #3a3a3a;\n            display: none;\n            gap: 12px;\n            background: #2a2a2a;\n            border-radius: 0 0 12px 12px;\n            flex-shrink: 0;\n        }\n        \n        .input-field {\n            flex: 1;\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n        }\n        \n        .input-field:focus {\n            border-color: #22c55e;\n        }\n        \n        .send-button {\n            padding: 12px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.95rem;\n            transition: background 0.2s ease;\n        }\n        \n        .send-button:hover {\n            background: #16a34a;\n        }\n        \n        .send-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .typing-indicator {\n            display: none;\n            padding: 12px 16px;\n            background: #3a3a3a;\n            border-radius: 12px;\n            max-width: 80px;\n            align-self: flex-start;\n            margin-bottom: 16px;\n        }\n        \n        .typing-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .dot {\n            width: 8px;\n            height: 8px;\n            background: #a1a1aa;\n            border-radius: 50%;\n            animation: typing 1.4s infinite;\n        }\n        \n        .dot:nth-child(2) { animation-delay: 0.2s; }\n        .dot:nth-child(3) { animation-delay: 0.4s; }\n        \n        @keyframes typing {\n            0%, 60%, 100% { transform: translateY(0); }\n            30% { transform: translateY(-10px); }\n        }\n        \n        .content-preview {\n            margin-top: 12px;\n            padding: 16px;\n            background: #2a2a2a;\n            border-radius: 12px;\n            border-left: 4px solid #22c55e;\n            max-width: 100%;\n            overflow: hidden;\n        }\n        \n        .content-title {\n            font-weight: 600;\n            font-size: 1.1rem;\n            margin-bottom: 12px;\n            color: #22c55e;\n        }\n        \n        .topic-item {\n            margin-bottom: 16px;\n            padding: 12px;\n            background: #333333;\n            border-radius: 8px;\n            border: 1px solid #4a4a4a;\n        }\n        \n        .topic-title {\n            font-weight: 600;\n            font-size: 1rem;\n            margin-bottom: 8px;\n            color: #e4e4e7;\n        }\n        \n        .topic-points {\n            margin-left: 16px;\n            margin-bottom: 8px;\n            color: #d4d4d8;\n        }\n        \n        .topic-summary {\n            font-style: italic;\n            color: #a1a1aa;\n            font-size: 0.9rem;\n        }\n\n        /* Responsividade */\n        @media (max-width: 768px) {\n            .chat-container {\n                margin: 10px;\n                max-width: calc(100vw - 20px);\n            }\n            \n            .chat-header {\n                flex-direction: column;\n                gap: 12px;\n                align-items: stretch;\n            }\n            \n            .training-button {\n                margin-left: 0;\n                align-self: flex-end;\n            }\n            \n            .form-container {\n                padding: 20px;\n            }\n            \n            .chat-messages {\n                max-height: calc(100vh - 250px);\n                padding: 16px;\n            }\n        }\n\n        /* Garantir que o container principal tenha scroll quando necess√°rio */\n        .chat-container.chat-active {\n            min-height: calc(100vh - 40px);\n            max-height: none;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"chat-container\" id=\"chatContainer\">\n        <div class=\"chat-header\">\n            <div class=\"header-content\">\n                <h2>Agente de Cria√ß√£o de Conte√∫do</h2>\n                <p>Especialista em conte√∫do para Instagram</p>\n            </div>\n        </div>\n        \n        <!-- Formul√°rio Inicial -->\n        <div class=\"form-container\" id=\"formContainer\">\n            <div class=\"form-title\">Configure seu conte√∫do</div>\n            <div class=\"form-subtitle\">Preencha as informa√ß√µes abaixo para come√ßar</div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"temaGeral\">1. Tema Geral</label>\n                <input type=\"text\" class=\"form-input\" id=\"temaGeral\" placeholder=\"Ex: Marketing Digital, Fitness, Culin√°ria...\">\n            </div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"topicoObrigatorio\">2. T√≥pico Obrigat√≥rio</label>\n                <input type=\"text\" class=\"form-input\" id=\"topicoObrigatorio\" placeholder=\"Digite um t√≥pico espec√≠fico ou deixe vazio\">\n                <div class=\"form-help\">Se n√£o tiver prefer√™ncia, deixe vazio (ser√° enviado como \"NENHUM\")</div>\n            </div>\n            \n            <div class=\"form-field\">\n                <label class=\"form-label\" for=\"quantidadeTopicos\">3. Quantidade de T√≥picos</label>\n                <select class=\"form-select\" id=\"quantidadeTopicos\">\n                    <option value=\"\">Selecione a quantidade</option>\n                    <option value=\"3\">3 t√≥picos</option>\n                    <option value=\"5\">5 t√≥picos</option>\n                    <option value=\"7\">7 t√≥picos</option>\n                    <option value=\"10\">10 t√≥picos</option>\n                </select>\n            </div>\n            \n            <button class=\"form-button\" onclick=\"startChat()\">Come√ßar Cria√ß√£o</button>\n            \n            <button class=\"form-training-button\" onclick=\"openTrainingPage()\">\n                üìö Treinar este Agente com um Documento\n            </button>\n        </div>\n        \n        <!-- Chat (oculto inicialmente) -->\n        <div class=\"chat-messages\" id=\"messages\"></div>\n        \n        <div class=\"typing-indicator\" id=\"typing\">\n            <div class=\"typing-dots\">\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n            </div>\n        </div>\n        \n        <div class=\"chat-input\" id=\"chatInput\">\n            <input type=\"text\" class=\"input-field\" id=\"messageInput\" placeholder=\"Digite sua mensagem...\">\n            <button class=\"send-button\" id=\"sendButton\" onclick=\"sendMessage()\">Enviar</button>\n        </div>\n    </div>\n\n    <script>\n        const WEBHOOK_URL = 'https://primary-production-70c40.up.railway.app/webhook/2d666699-53d5-4ceb-ac71-913ee7125e6f';\n        const TRAINING_URL = 'https://primary-production-70c40.up.railway.app/webhook/updatefile-rag';\n        let isProcessing = false;\n        let formData = {};\n        \n        function openTrainingPage() {\n            window.open(TRAINING_URL, '_blank');\n        }\n        \n        function startChat() {\n            const temaGeral = document.getElementById('temaGeral').value.trim();\n            const topicoObrigatorio = document.getElementById('topicoObrigatorio').value.trim();\n            const quantidadeTopicos = document.getElementById('quantidadeTopicos').value;\n            \n            // Valida√ß√£o\n            if (!temaGeral) {\n                alert('Por favor, preencha o tema geral');\n                return;\n            }\n            \n            if (!quantidadeTopicos) {\n                alert('Por favor, selecione a quantidade de t√≥picos');\n                return;\n            }\n            \n            // Armazena os dados do formul√°rio\n            // Se t√≥pico obrigat√≥rio estiver vazio, usa \"NENHUM\"\n            const topicoFinal = topicoObrigatorio || 'NENHUM';\n            \n            formData = {\n                temaGeral,\n                topicoObrigatorio: topicoFinal,\n                quantidadeTopicos\n            };\n            \n            // Adiciona classe para ativar modo chat\n            document.getElementById('chatContainer').classList.add('chat-active');\n            \n            // Oculta o formul√°rio e mostra o chat\n            document.getElementById('formContainer').style.display = 'none';\n            document.getElementById('messages').style.display = 'flex';\n            document.getElementById('chatInput').style.display = 'flex';\n            \n            // Cria mensagem inicial no formato exato exigido (3 linhas)\n            const initialMessage = `${temaGeral}\\n${topicoFinal}\\n${quantidadeTopicos}`;\n            \n            // Adiciona mensagem de boas-vindas\n            addMessage(`Perfeito! Vou criar conte√∫do sobre \"${temaGeral}\" com ${quantidadeTopicos} t√≥picos.`, 'assistant');\n            \n            if (topicoFinal !== 'NENHUM') {\n                addMessage(`T√≥pico obrigat√≥rio inclu√≠do: \"${topicoFinal}\"`, 'assistant');\n            } else {\n                addMessage('Sem t√≥pico obrigat√≥rio espec√≠fico.', 'assistant');\n            }\n            \n            addMessage('Processando sua solicita√ß√£o...', 'assistant');\n            \n            // Envia automaticamente a primeira mensagem\n            sendInitialMessage(initialMessage);\n        }\n        \n        async function sendInitialMessage(message) {\n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Como posso ajudar voc√™ a refinar este conte√∫do?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        function addMessage(content, type = 'assistant') {\n            const messagesContainer = document.getElementById('messages');\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${type}`;\n\n            if (typeof content === 'string') {\n                // Verifica se o conte√∫do cont√©m m√∫ltiplos links\n                const lines = content.trim().split('\\n');\n                const links = lines.filter(line => /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                \n                if (links.length > 0 && type === 'assistant') {\n                    // Se h√° links, cria um container para os bot√µes\n                    const linksContainer = document.createElement('div');\n                    linksContainer.style.display = 'flex';\n                    linksContainer.style.flexDirection = 'column';\n                    linksContainer.style.gap = '8px';\n                    \n                    links.forEach((link, index) => {\n                        const button = document.createElement('button');\n                        button.textContent = `Abrir Link ${index + 1}`;\n                        button.onclick = () => window.open(link.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        button.style.transition = 'background 0.2s ease';\n                        \n                        // Adiciona hover effect\n                        button.addEventListener('mouseenter', () => {\n                            button.style.background = '#16a34a';\n                        });\n                        button.addEventListener('mouseleave', () => {\n                            button.style.background = '#22c55e';\n                        });\n                        \n                        linksContainer.appendChild(button);\n                    });\n                    \n                    // Se h√° texto al√©m dos links, adiciona antes dos bot√µes\n                    const nonLinkLines = lines.filter(line => !/^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                    if (nonLinkLines.length > 0) {\n                        const textDiv = document.createElement('div');\n                        textDiv.textContent = nonLinkLines.join('\\n');\n                        textDiv.style.marginBottom = '12px';\n                        messageDiv.appendChild(textDiv);\n                    }\n                    \n                    messageDiv.appendChild(linksContainer);\n                } else {\n                    // Caso n√£o seja link ou seja um link √∫nico sem quebras de linha\n                    const isLink = /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(content.trim());\n                    if (isLink && type === 'assistant') {\n                        const button = document.createElement('button');\n                        button.textContent = 'Abrir Link';\n                        button.onclick = () => window.open(content.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        messageDiv.appendChild(button);\n                    } else {\n                        messageDiv.textContent = content;\n                    }\n                }\n            } else {\n                messageDiv.appendChild(content);\n            }\n\n            messagesContainer.appendChild(messageDiv);\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n\n        function addContentPreview(jsonData) {\n            const previewDiv = document.createElement('div');\n            previewDiv.className = 'content-preview';\n            \n            const titleDiv = document.createElement('div');\n            titleDiv.className = 'content-title';\n            titleDiv.textContent = `üìã ${jsonData.titulo_geral} (${jsonData.quantidade_topicos} t√≥picos)`;\n            previewDiv.appendChild(titleDiv);\n            \n            jsonData.topicos.forEach(topico => {\n                const topicDiv = document.createElement('div');\n                topicDiv.className = 'topic-item';\n                \n                const topicTitle = document.createElement('div');\n                topicTitle.className = 'topic-title';\n                topicTitle.textContent = `${topico.id}. ${topico.titulo}`;\n                topicDiv.appendChild(topicTitle);\n                \n                const pointsList = document.createElement('div');\n                pointsList.className = 'topic-points';\n                topico.pontos_chave.forEach(ponto => {\n                    const pointDiv = document.createElement('div');\n                    pointDiv.textContent = `‚Ä¢ ${ponto}`;\n                    pointsList.appendChild(pointDiv);\n                });\n                topicDiv.appendChild(pointsList);\n                \n                const summaryDiv = document.createElement('div');\n                summaryDiv.className = 'topic-summary';\n                summaryDiv.textContent = topico.resumo;\n                topicDiv.appendChild(summaryDiv);\n                \n                previewDiv.appendChild(topicDiv);\n            });\n            \n            return previewDiv;\n        }\n        \n        function showTyping() {\n            const messagesContainer = document.getElementById('messages');\n            const typingIndicator = document.getElementById('typing');\n            \n            messagesContainer.appendChild(typingIndicator);\n            typingIndicator.style.display = 'block';\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n        \n        function hideTyping() {\n            const typingIndicator = document.getElementById('typing');\n            typingIndicator.style.display = 'none';\n        }\n        \n        function setProcessing(processing) {\n            isProcessing = processing;\n            const sendButton = document.getElementById('sendButton');\n            const messageInput = document.getElementById('messageInput');\n            \n            sendButton.disabled = processing;\n            messageInput.disabled = processing;\n            sendButton.textContent = processing ? 'Processando...' : 'Enviar';\n        }\n        \n        async function sendMessage() {\n            const input = document.getElementById('messageInput');\n            const message = input.value.trim();\n            \n            if (!message || isProcessing) return;\n            \n            addMessage(message, 'user');\n            input.value = '';\n            \n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas para Instagram...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Como posso ajudar voc√™ a refinar este conte√∫do?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        document.getElementById('messageInput').addEventListener('keypress', function(e) {\n            if (e.key === 'Enter' && !isProcessing) {\n                sendMessage();\n            }\n        });\n    </script>\n</body>\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[180,0],"id":"c1815231-089f-41c4-b770-151d3575eca6","name":"HTML"},{"parameters":{"respondWith":"text","responseBody":"={{ $json.html }}","options":{}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.2,"position":[420,0],"id":"fa29ce02-c2e1-46ee-97b5-5d8deabbedba","name":"Respond to Webhook1"},{"parameters":{"content":"## DOWNLOAD","height":240,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[-260,-60],"typeVersion":1,"id":"245a17f0-7055-4f39-aa99-eba598adc645","name":"Sticky Note"},{"parameters":{"html":"<!DOCTYPE html>\n<html lang=\"pt-BR\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Agente de Conte√∫do</title>\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\" rel=\"stylesheet\">\n    <style>\n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);\n            height: 100vh;\n            display: flex;\n            flex-direction: column;\n            color: #e4e4e7;\n        }\n        \n        .chat-container {\n            max-width: 800px;\n            margin: 20px auto;\n            height: calc(100vh - 40px);\n            display: flex;\n            flex-direction: column;\n            background: #222222;\n            border-radius: 12px;\n            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);\n            overflow: hidden;\n        }\n        \n        .chat-header {\n            padding: 24px;\n            border-bottom: 1px solid #3a3a3a;\n            background: #2a2a2a;\n        }\n        \n        .chat-header h2 {\n            font-size: 1.5rem;\n            font-weight: 600;\n            color: #ffffff;\n        }\n        \n        .chat-header p {\n            font-size: 0.9rem;\n            color: #a1a1aa;\n            margin-top: 4px;\n        }\n        \n        .chat-messages {\n            flex: 1;\n            overflow-y: auto;\n            padding: 24px;\n            display: flex;\n            flex-direction: column;\n            gap: 16px;\n            scrollbar-width: thin;\n            scrollbar-color: #4a4a4a #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar {\n            width: 6px;\n        }\n        \n        .chat-messages::-webkit-scrollbar-track {\n            background: #222222;\n        }\n        \n        .chat-messages::-webkit-scrollbar-thumb {\n            background: #4a4a4a;\n            border-radius: 3px;\n        }\n        \n        .message {\n            max-width: 75%;\n            padding: 12px 16px;\n            border-radius: 12px;\n            line-height: 1.5;\n            white-space: pre-wrap;\n            font-size: 0.95rem;\n            transition: all 0.2s ease;\n        }\n        \n        .message.user {\n            align-self: flex-end;\n            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);\n            color: #ffffff;\n        }\n        \n        .message.assistant {\n            align-self: flex-start;\n            background: #3a3a3a;\n            color: #e4e4e7;\n        }\n        \n        .message.success {\n            align-self: flex-start;\n            background: #22c55e;\n            color: #ffffff;\n        }\n        \n        .message.error {\n            align-self: flex-start;\n            background: #ef4444;\n            color: #ffffff;\n        }\n        \n        .chat-input {\n            padding: 20px;\n            border-top: 1px solid #3a3a3a;\n            display: flex;\n            gap: 12px;\n            background: #2a2a2a;\n        }\n        \n        .input-field {\n            flex: 1;\n            padding: 12px 16px;\n            border: 1px solid #4a4a4a;\n            border-radius: 12px;\n            outline: none;\n            font-size: 0.95rem;\n            background: #333333;\n            color: #e4e4e7;\n            transition: border-color 0.2s ease;\n        }\n        \n        .input-field:focus {\n            border-color: #22c55e;\n        }\n        \n        .send-button {\n            padding: 12px 24px;\n            background: #22c55e;\n            color: #ffffff;\n            border: none;\n            border-radius: 12px;\n            cursor: pointer;\n            font-weight: 500;\n            font-size: 0.95rem;\n            transition: background 0.2s ease;\n        }\n        \n        .send-button:hover {\n            background: #16a34a;\n        }\n        \n        .send-button:disabled {\n            background: #4a4a4a;\n            cursor: not-allowed;\n        }\n        \n        .typing-indicator {\n            display: none;\n            padding: 12px 16px;\n            background: #3a3a3a;\n            border-radius: 12px;\n            max-width: 80px;\n            align-self: flex-start;\n        }\n        \n        .typing-dots {\n            display: flex;\n            gap: 4px;\n        }\n        \n        .dot {\n            width: 8px;\n            height: 8px;\n            background: #a1a1aa;\n            border-radius: 50%;\n            animation: typing 1.4s infinite;\n        }\n        \n        .dot:nth-child(2) { animation-delay: 0.2s; }\n        .dot:nth-child(3) { animation-delay: 0.4s; }\n        \n        @keyframes typing {\n            0%, 60%, 100% { transform: translateY(0); }\n            30% { transform: translateY(-10px); }\n        }\n        \n        .content-preview {\n            margin-top: 12px;\n            padding: 16px;\n            background: #2a2a2a;\n            border-radius: 12px;\n            border-left: 4px solid #22c55e;\n        }\n        \n        .content-title {\n            font-weight: 600;\n            font-size: 1.1rem;\n            margin-bottom: 12px;\n            color: #22c55e;\n        }\n        \n        .topic-item {\n            margin-bottom: 16px;\n            padding: 12px;\n            background: #333333;\n            border-radius: 8px;\n            border: 1px solid #4a4a4a;\n        }\n        \n        .topic-title {\n            font-weight: 600;\n            font-size: 1rem;\n            margin-bottom: 8px;\n            color: #e4e4e7;\n        }\n        \n        .topic-points {\n            margin-left: 16px;\n            margin-bottom: 8px;\n            color: #d4d4d8;\n        }\n        \n        .topic-summary {\n            font-style: italic;\n            color: #a1a1aa;\n            font-size: 0.9rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"chat-container\">\n        <div class=\"chat-header\">\n            <h2>Agente de Cria√ß√£o de Conte√∫do</h2>\n            <p>Especialista em conte√∫do para Instagram</p>\n        </div>\n        \n        <div class=\"chat-messages\" id=\"messages\">\n            <div class=\"message assistant\">Ol√°! Sou seu agente especializado em cria√ß√£o de conte√∫do. Sobre qual tema voc√™ gostaria de criar um post para Instagram?</div>\n        </div>\n        \n        <div class=\"typing-indicator\" id=\"typing\">\n            <div class=\"typing-dots\">\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n                <div class=\"dot\"></div>\n            </div>\n        </div>\n        \n        <div class=\"chat-input\">\n            <input type=\"text\" class=\"input-field\" id=\"messageInput\" placeholder=\"Digite o tema do seu conte√∫do...\">\n            <button class=\"send-button\" id=\"sendButton\" onclick=\"sendMessage()\">Enviar</button>\n        </div>\n    </div>\n\n    <script>\n        const WEBHOOK_URL = 'https://primary-production-70c40.up.railway.app/webhook/2d666699-53d5-4ceb-ac71-913ee7125e6f';\n        let isProcessing = false;\n        \n        function addMessage(content, type = 'assistant') {\n            const messagesContainer = document.getElementById('messages');\n            const messageDiv = document.createElement('div');\n            messageDiv.className = `message ${type}`;\n\n            if (typeof content === 'string') {\n                // Verifica se o conte√∫do cont√©m m√∫ltiplos links\n                const lines = content.trim().split('\\n');\n                const links = lines.filter(line => /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                \n                if (links.length > 0 && type === 'assistant') {\n                    // Se h√° links, cria um container para os bot√µes\n                    const linksContainer = document.createElement('div');\n                    linksContainer.style.display = 'flex';\n                    linksContainer.style.flexDirection = 'column';\n                    linksContainer.style.gap = '8px';\n                    \n                    links.forEach((link, index) => {\n                        const button = document.createElement('button');\n                        button.textContent = `Abrir Link ${index + 1}`;\n                        button.onclick = () => window.open(link.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        button.style.transition = 'background 0.2s ease';\n                        \n                        // Adiciona hover effect\n                        button.addEventListener('mouseenter', () => {\n                            button.style.background = '#16a34a';\n                        });\n                        button.addEventListener('mouseleave', () => {\n                            button.style.background = '#22c55e';\n                        });\n                        \n                        linksContainer.appendChild(button);\n                    });\n                    \n                    // Se h√° texto al√©m dos links, adiciona antes dos bot√µes\n                    const nonLinkLines = lines.filter(line => !/^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(line.trim()));\n                    if (nonLinkLines.length > 0) {\n                        const textDiv = document.createElement('div');\n                        textDiv.textContent = nonLinkLines.join('\\n');\n                        textDiv.style.marginBottom = '12px';\n                        messageDiv.appendChild(textDiv);\n                    }\n                    \n                    messageDiv.appendChild(linksContainer);\n                } else {\n                    // Caso n√£o seja link ou seja um link √∫nico sem quebras de linha\n                    const isLink = /^https?:\\/\\/[\\w\\-._~:/?#[\\]@!$&'()*+,;=.]+$/.test(content.trim());\n                    if (isLink && type === 'assistant') {\n                        const button = document.createElement('button');\n                        button.textContent = 'Abrir Link';\n                        button.onclick = () => window.open(content.trim(), '_blank');\n                        button.style.padding = '10px 16px';\n                        button.style.borderRadius = '12px';\n                        button.style.border = 'none';\n                        button.style.background = '#22c55e';\n                        button.style.color = '#ffffff';\n                        button.style.cursor = 'pointer';\n                        button.style.fontWeight = '500';\n                        button.style.fontFamily = 'Inter, sans-serif';\n                        messageDiv.appendChild(button);\n                    } else {\n                        messageDiv.textContent = content;\n                    }\n                }\n            } else {\n                messageDiv.appendChild(content);\n            }\n\n            messagesContainer.appendChild(messageDiv);\n            messagesContainer.scrollTop = messagesContainer.scrollHeight;\n        }\n\n        function addContentPreview(jsonData) {\n            const previewDiv = document.createElement('div');\n            previewDiv.className = 'content-preview';\n            \n            const titleDiv = document.createElement('div');\n            titleDiv.className = 'content-title';\n            titleDiv.textContent = `üìã ${jsonData.titulo_geral} (${jsonData.quantidade_topicos} t√≥picos)`;\n            previewDiv.appendChild(titleDiv);\n            \n            jsonData.topicos.forEach(topico => {\n                const topicDiv = document.createElement('div');\n                topicDiv.className = 'topic-item';\n                \n                const topicTitle = document.createElement('div');\n                topicTitle.className = 'topic-title';\n                topicTitle.textContent = `${topico.id}. ${topico.titulo}`;\n                topicDiv.appendChild(topicTitle);\n                \n                const pointsList = document.createElement('div');\n                pointsList.className = 'topic-points';\n                topico.pontos_chave.forEach(ponto => {\n                    const pointDiv = document.createElement('div');\n                    pointDiv.textContent = `‚Ä¢ ${ponto}`;\n                    pointsList.appendChild(pointDiv);\n                });\n                topicDiv.appendChild(pointsList);\n                \n                const summaryDiv = document.createElement('div');\n                summaryDiv.className = 'topic-summary';\n                summaryDiv.textContent = topico.resumo;\n                topicDiv.appendChild(summaryDiv);\n                \n                previewDiv.appendChild(topicDiv);\n            });\n            \n            return previewDiv;\n        }\n        \n        function showTyping() {\n            document.getElementById('typing').style.display = 'block';\n            document.getElementById('messages').scrollTop = document.getElementById('messages').scrollHeight;\n        }\n        \n        function hideTyping() {\n            document.getElementById('typing').style.display = 'none';\n        }\n        \n        function setProcessing(processing) {\n            isProcessing = processing;\n            const sendButton = document.getElementById('sendButton');\n            const messageInput = document.getElementById('messageInput');\n            \n            sendButton.disabled = processing;\n            messageInput.disabled = processing;\n            sendButton.textContent = processing ? 'Processando...' : 'Enviar';\n        }\n        \n        async function sendMessage() {\n            const input = document.getElementById('messageInput');\n            const message = input.value.trim();\n            \n            if (!message || isProcessing) return;\n            \n            addMessage(message, 'user');\n            input.value = '';\n            \n            setProcessing(true);\n            showTyping();\n            \n            try {\n                const response = await fetch(WEBHOOK_URL, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        body: {\n                            data: {\n                                message: {\n                                    conversation: message\n                                }\n                            }\n                        }\n                    })\n                });\n                \n                if (!response.ok) {\n                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n                }\n                \n                const result = await response.text();\n                hideTyping();\n                \n                try {\n                    const jsonMatch = result.match(/\\{[\\s\\S]*\\}/);\n                    if (jsonMatch) {\n                        const jsonData = JSON.parse(jsonMatch[0]);\n                        \n                        addMessage('‚úÖ Conte√∫do gerado com sucesso!', 'success');\n                        \n                        const preview = addContentPreview(jsonData);\n                        addMessage(preview, 'assistant');\n                        \n                        addMessage('üé® Imagens sendo geradas e otimizadas para Instagram...', 'assistant');\n                        \n                        setTimeout(() => {\n                            addMessage('Gostaria de criar outro conte√∫do sobre um tema diferente?', 'assistant');\n                        }, 1000);\n                        \n                    } else {\n                        addMessage(result, 'assistant');\n                    }\n                } catch (parseError) {\n                    addMessage(result, 'assistant');\n                }\n                \n            } catch (error) {\n                hideTyping();\n                console.error('Erro na requisi√ß√£o:', error);\n                addMessage(`‚ùå Erro ao processar mensagem: ${error.message}`, 'error');\n            } finally {\n                setProcessing(false);\n            }\n        }\n        \n        document.getElementById('messageInput').addEventListener('keypress', function(e) {\n            if (e.key === 'Enter' && !isProcessing) {\n                sendMessage();\n            }\n        });\n    </script>\n</body>\n</html>"},"type":"n8n-nodes-base.html","typeVersion":1.2,"position":[180,720],"id":"531eb6ac-63df-46de-83aa-cc80a342c58a","name":"HTML1"},{"parameters":{"content":"## BACKUP","height":240,"width":1020},"type":"n8n-nodes-base.stickyNote","position":[-260,660],"typeVersion":1,"id":"bdd71e07-d424-4810-a7f7-acf709769322","name":"Sticky Note1"}],"connections":{"Webhook":{"main":[[{"node":"HTML","type":"main","index":0}]]},"HTML":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0}]]},"HTML1":{"main":[[]]}},"authors":"system migration","name":null,"description":null,"autosaved":false},"tags":[]}